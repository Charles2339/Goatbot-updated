// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//   addgc.js  â€”  Add the bot (or owner) to a Group Chat by TID
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

module.exports = {
  config: {
    name: "addgc",
    aliases: ["joingroup", "addme"],
    version: "1.0",
    author: "Charles MK",
    countDown: 5,
    role: 2, // Admin/owner only
    shortDescription: { en: "Add bot owner to a group chat by Thread ID" },
    category: "owner",
    guide: {
      en: "+addgc {threadID} â€” Makes the bot add you to the specified group chat",
    },
  },

  onStart: async function ({ event, message, api, args, admins }) {
    const senderID = event.senderID;

    // â”€â”€ Validate input â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const threadID = args[0];

    if (!threadID) {
      return message.reply(
        `âŒ ğ— ğ—¶ğ˜€ğ˜€ğ—¶ğ—»ğ—´ ğ—§ğ—µğ—¿ğ—²ğ—®ğ—± ğ—œğ——!\n` +
        `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n` +
        `ğŸ“Œ ğ—¨ğ˜€ğ—®ğ—´ğ—²: +addgc {threadID}\n` +
        `ğŸ’¡ ğ—˜ğ˜…ğ—®ğ—ºğ—½ğ—¹ğ—²: +addgc 1234567890123`
      );
    }

    if (!/^\d+$/.test(threadID)) {
      return message.reply(
        `âŒ ğ—œğ—»ğ˜ƒğ—®ğ—¹ğ—¶ğ—± ğ—§ğ—µğ—¿ğ—²ğ—®ğ—± ğ—œğ——!\n` +
        `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n` +
        `ğŸ“Œ ğ—§ğ—µğ—² ğ—§ğ—µğ—¿ğ—²ğ—®ğ—± ğ—œğ—— ğ—ºğ˜‚ğ˜€ğ˜ ğ—¯ğ—² ğ—»ğ˜‚ğ—ºğ—¯ğ—²ğ—¿ğ˜€ ğ—¼ğ—»ğ—¹ğ˜†.`
      );
    }

    // â”€â”€ Confirm attempt â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    await message.reply(
      `â³ ğ—”ğ˜ğ˜ğ—²ğ—ºğ—½ğ˜ğ—¶ğ—»ğ—´ ğ˜ğ—¼ ğ—®ğ—±ğ—± ğ˜†ğ—¼ğ˜‚...\n` +
      `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n` +
      `ğŸ”— ğ—§ğ—µğ—¿ğ—²ğ—®ğ—± ğ—œğ——: ${threadID}`
    );

    // â”€â”€ Try to add sender to the group chat â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    try {
      await api.addUserToGroup(senderID, threadID);

      return message.reply(
        `âœ… ğ—¦ğ˜‚ğ—°ğ—°ğ—²ğ˜€ğ˜€!\n` +
        `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n` +
        `ğŸ‰ ğ—¬ğ—¼ğ˜‚ ğ—µğ—®ğ˜ƒğ—² ğ—¯ğ—²ğ—²ğ—» ğ—®ğ—±ğ—±ğ—²ğ—± ğ˜ğ—¼ ğ˜ğ—µğ—² ğ—´ğ—¿ğ—¼ğ˜‚ğ—½!\n` +
        `ğŸ”— ğ—§ğ—µğ—¿ğ—²ğ—®ğ—± ğ—œğ——: ${threadID}`
      );
    } catch (err) {
      // â”€â”€ Handle common errors â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      let errMsg = `âŒ ğ—™ğ—®ğ—¶ğ—¹ğ—²ğ—± ğ˜ğ—¼ ğ—®ğ—±ğ—± ğ˜†ğ—¼ğ˜‚ ğ˜ğ—¼ ğ˜ğ—µğ—² ğ—´ğ—¿ğ—¼ğ˜‚ğ—½!\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;

      if (err.error === 1545012) {
        errMsg += `âš ï¸ ğ—§ğ—µğ—² ğ—¯ğ—¼ğ˜ ğ—¶ğ˜€ ğ—»ğ—¼ğ˜ ğ—¶ğ—» ğ˜ğ—µğ—®ğ˜ ğ—´ğ—¿ğ—¼ğ˜‚ğ—½ ğ—°ğ—µğ—®ğ˜.\nğ˜Œğ˜¯ğ˜´ğ˜¶ğ˜³ğ˜¦ ğ˜µğ˜©ğ˜¦ ğ˜£ğ˜°ğ˜µ ğ˜ªğ˜´ ğ˜¢ğ˜­ğ˜³ğ˜¦ğ˜¢ğ˜¥ğ˜º ğ˜¢ ğ˜®ğ˜¦ğ˜®ğ˜£ğ˜¦ğ˜³ ğ˜°ğ˜§ ğ˜µğ˜©ğ˜¦ ğ˜ğ˜Š.`;
      } else if (err.error === 200) {
        errMsg += `âš ï¸ ğ—£ğ—²ğ—¿ğ—ºğ—¶ğ˜€ğ˜€ğ—¶ğ—¼ğ—» ğ—±ğ—²ğ—»ğ—¶ğ—²ğ—±.\nğ˜›ğ˜©ğ˜¦ ğ˜£ğ˜°ğ˜µ ğ˜®ğ˜¢ğ˜º ğ˜¯ğ˜°ğ˜µ ğ˜©ğ˜¢ğ˜·ğ˜¦ ğ˜¢ğ˜¥ğ˜®ğ˜ªğ˜¯ ğ˜³ğ˜ªğ˜¨ğ˜©ğ˜µğ˜´ ğ˜µğ˜° ğ˜¢ğ˜¥ğ˜¥ ğ˜®ğ˜¦ğ˜®ğ˜£ğ˜¦ğ˜³ğ˜´.`;
      } else if (err.error === 100) {
        errMsg += `âš ï¸ ğ—œğ—»ğ˜ƒğ—®ğ—¹ğ—¶ğ—± ğ—§ğ—µğ—¿ğ—²ğ—®ğ—± ğ—œğ——.\nğ˜›ğ˜©ğ˜¦ ğ˜¨ğ˜³ğ˜°ğ˜¶ğ˜± ğ˜¤ğ˜©ğ˜¢ğ˜µ ğ˜¥ğ˜°ğ˜¦ğ˜´ ğ˜¯ğ˜°ğ˜µ ğ˜¦ğ˜¹ğ˜ªğ˜´ğ˜µ ğ˜°ğ˜³ ğ˜¤ğ˜¢ğ˜¯ğ˜¯ğ˜°ğ˜µ ğ˜£ğ˜¦ ğ˜§ğ˜°ğ˜¶ğ˜¯ğ˜¥.`;
      } else {
        errMsg += `ğŸ”´ ğ—˜ğ—¿ğ—¿ğ—¼ğ—¿: ${err.message || JSON.stringify(err)}`;
      }

      return message.reply(errMsg);
    }
  },
};
